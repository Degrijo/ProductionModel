
# Production Model
BSUIR lab 5 sem AI

## Основная структура
Проект включает в себя:
 * папка `venv`, хранящая виртуальное окружение (которое ты создавала сама);
 * файл `manage.py` - управляющий, через него создаем миграции для проекта и запускаем сервер;
 * файл `requirements.txt` - содержит зависимости (модули) и их версии, необходимые для работы этого проекта;
 * папка `production` (создается самим проектом с названием проекта) - стандартное приложение, в котором находятся настройки этого проекта и начальные пути(в дальнейшем юрлы);
 * папка `core` - основное приложение проекта, его структура описана ниже.

## Приложение Core

* папка `migrations` (создается самим проектом при первой миграции) - стандартная папка, хранит миграции - связь между базой данных и моделями проекта;
* папка `static` хранит статические файлы нашего проекта - css (стили), js (анимация) и просто картинки - в данном проекте только css;
* папка `templates` содержит в себе (так принято) папку с названием проекта и в ней находятся html шаблоны этого проекта;
* файлы `__init__.py`, `admin.py`, `apps.py`, `forms.py`, `test.py` (создаются самим проектом) - в данном проекте они не используются;
* файл `urls.py` - хранит пути к отображениям (далее вьюхам) проекта, некоторые содержат в себе `pk` - primary key - `id` объекта, к которому мы обращаемся, `filter` - критерий, по которому фильтруем список;
* файл `models.py`, в нем находятся модели твоего приложение (проекта тоже). Модель в Django - это элемент ORM, который в базе данных представлен в виде таблицы. Поля модели являются колонками в таблице, а объекты - записями соответственно. В данном проекте 4 модели (сущности) - `Inventory` (инвентарь), `Stock` (склад), `Waybill` (отчет), `InventoryWaybillStock`(связывающая таблица). Их физические связи указаны ниже в диаграмме. У модели `Inventory` есть 2 поля - имя и тип (выбирается из конкретных 4, описанных выше) и метод __str__, который возвращает строку с именем и типом. У склада 3 поля - имя, номер телефона и связь `ManyToMany` через таблицу `InventoryWaybillStock` - через эту связь мы получаем весь инвентарь, который есть или был на этом складе. В модели `Waybill` есть поле с датой и временем создания (заполняется автоматически), поле с именем сотрудника, который создавал этот отчет, поле с должностью этого сотрудника, поле, которое показывает, этот отчет о ввозе или вывозе инвентаря, поле со связью `ManyToMany` через таблицу `InventoryWaybillStock` - через эту связь мы получаем инвентарь, который приняли на склад или отдали. И, собственно, сама промежуточная таблица `InventoryWaybillStock`, записи которой хранят определенный инвентарь, склад, на который этот инвентарь был отправлен (с которого забрали), отчет, который описывал изменение этого товара;
* файл `view.py` - файл с представлениями. Использовались стандартные вьюхи на создание (`CreateView`), вывод списка (`ListView`), редактирование (`UpdateView`) и просмотр отдельного объекта (`DetailView`) - они позволяют не прописывать запросы напрямую и имеют готовую форму. Каждая стандартная вьюха имеет поле `template_name` - имя html шаблона, который нужно отобразить, `success_url` - путь, по которому мы перенаправимся, в случае удачного заполнения формы, `model` - модель, к которой обращаемся, `fields` - поля модели, которые используются в форме это вьюхи. `get_contex_data` - метод, который передает данные из вьюхи в html, метод `post` - отправка запроса из шаблона html во вьюху, из него вызывается метод `form_valid` или `form_invalid` (если они не определяются явно, то используются стандартные методы вьюхи).

Рассмотрим один из немногих запросов на ORM:
	`context['waybills'] = self.get_object().inventory_waybill_stock.values('waybill__created_at', 'inventory_number', 'waybill__id')`
	`self` в данном случае DetailView, у это вьюхи вызываем метод get_object(), тем самым беря объект модели, которую мы указали в `model`, у этого объекта мы берем все связанные объекты модели `InventoryWaybillStock`, а у множества этих объектов мы достаем поля `waybill__created_at`, 'inventory_number' и 'waybill__id'.